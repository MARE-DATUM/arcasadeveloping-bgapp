<!DOCTYPE html>
<html lang="pt">
<head>
    <!-- Favicon BGAPP -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="theme-color" content="#173c72">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGAPP - Sistema Avan√ßado de Anima√ß√µes</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    
    <!-- Estilos customizados -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            overflow-x: hidden;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 2000;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 300;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header .subtitle {
            font-size: 14px;
            opacity: 0.7;
            margin-top: 5px;
        }

        #map {
            height: 100vh;
            width: 100%;
            position: relative;
        }

        .control-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 280px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            z-index: 1500;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #4fc3f7;
            border-bottom: 1px solid rgba(79, 195, 247, 0.3);
            padding-bottom: 5px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            font-size: 12px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .btn {
            background: linear-gradient(45deg, #007acc, #4fc3f7);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 195, 247, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: linear-gradient(45deg, #666, #888);
        }

        .btn.danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .slider {
            width: 100%;
            height: 4px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #4fc3f7;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #4fc3f7;
            cursor: pointer;
            border: none;
        }

        .stats-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
            z-index: 1500;
        }

        .stats-panel h4 {
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .demo-info {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 300px;
            z-index: 1500;
        }

        .demo-info h3 {
            color: #4fc3f7;
            margin-bottom: 10px;
        }

        .demo-info ul {
            list-style: none;
            font-size: 12px;
            line-height: 1.6;
        }

        .demo-info li {
            margin-bottom: 8px;
            padding-left: 16px;
            position: relative;
        }

        .demo-info li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #4fc3f7;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 3000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #4fc3f7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 16px;
            opacity: 0.8;
        }

        .floating-animations {
            position: fixed;
            top: 50%;
            right: 50px;
            transform: translateY(-50%);
            z-index: 1600;
        }

        .animation-item {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .animation-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .control-panel {
                right: 10px;
                left: 10px;
                top: 80px;
                max-height: 40vh;
            }
            
            .demo-info {
                display: none;
            }
            
            .stats-panel {
                bottom: 10px;
                left: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>
            üåä BGAPP - Sistema Avan√ßado de Anima√ß√µes
        </h1>
        <div class="subtitle">
            Demonstra√ß√£o das novas funcionalidades de anima√ß√£o para mapas oceanogr√°ficos
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Carregando sistema de anima√ß√µes...</div>
    </div>

    <!-- Mapa -->
    <div id="map"></div>

    <!-- Painel de Controle -->
    <div class="control-panel">
        <div class="control-section">
            <h3>üéÆ Controles de Anima√ß√£o</h3>
            
            <div class="control-group">
                <button class="btn" onclick="startLeafletNativeAnimations()">
                    üåä Anima√ß√µes Nativas Leaflet
                </button>
                <button class="btn" onclick="startAdvancedAnimations()">
                    ‚ñ∂Ô∏è Iniciar Anima√ß√µes Avan√ßadas
                </button>
                <button class="btn secondary" onclick="pauseAllAnimations()">
                    ‚è∏Ô∏è Pausar Todas
                </button>
                <button class="btn danger" onclick="stopAllAnimations()">
                    ‚èπÔ∏è Parar Todas
                </button>
            </div>
        </div>

        <div class="control-section">
            <h3>üå™Ô∏è Dados Meteorol√≥gicos</h3>
            
            <div class="control-group">
                <button class="btn" onclick="loadWindyData()">
                    üå¨Ô∏è Carregar Dados de Vento
                </button>
                <button class="btn" onclick="loadWaveData()">
                    üåä Carregar Dados de Ondas
                </button>
                <button class="btn" onclick="loadCurrentsData()">
                    üåÄ Carregar Correntes
                </button>
            </div>
        </div>

        <div class="control-section">
            <h3>‚ú® Anima√ß√µes Lottie</h3>
            
            <div class="control-group">
                <button class="btn" onclick="showLoadingAnimation()">
                    ‚è≥ Mostrar Loading
                </button>
                <button class="btn" onclick="showSuccessAnimation()">
                    ‚úÖ Mostrar Sucesso
                </button>
                <button class="btn" onclick="showWeatherAlert()">
                    ‚ö†Ô∏è Alerta Meteorol√≥gico
                </button>
            </div>
        </div>

        <div class="control-section">
            <h3>‚è∞ Anima√ß√µes Temporais</h3>
            
            <div class="control-group">
                <button class="btn" onclick="startTimeAnimation()">
                    ‚ñ∂Ô∏è Iniciar Timeline
                </button>
                <button class="btn secondary" onclick="pauseTimeAnimation()">
                    ‚è∏Ô∏è Pausar Timeline
                </button>
                <button class="btn" onclick="showRippleEffect()">
                    üí´ Efeito Ondula√ß√£o
                </button>
            </div>
        </div>

        <div class="control-section">
            <h3>üé¨ Transi√ß√µes GSAP</h3>
            
            <div class="control-group">
                <button class="btn" onclick="animatePanel()">
                    üì± Animar Painel
                </button>
                <button class="btn" onclick="showNotification()">
                    üì¢ Mostrar Notifica√ß√£o
                </button>
                <button class="btn" onclick="animateCounters()">
                    üî¢ Animar Contadores
                </button>
            </div>
        </div>

        <div class="control-section">
            <h3>‚öôÔ∏è Configura√ß√µes</h3>
            
            <div class="control-group">
                <label>Velocidade de Anima√ß√£o:</label>
                <input type="range" class="slider" id="animationSpeed" 
                       min="0.1" max="3" step="0.1" value="1" 
                       onchange="updateAnimationSpeed(this.value)">
                <span id="speedValue">1.0x</span>
            </div>
            
            <div class="control-group">
                <label>Densidade de Part√≠culas:</label>
                <input type="range" class="slider" id="particleDensity" 
                       min="1000" max="10000" step="500" value="5000" 
                       onchange="updateParticleDensity(this.value)">
                <span id="densityValue">5000</span>
            </div>
        </div>
    </div>

    <!-- Informa√ß√µes da Demo -->
    <div class="demo-info">
        <h3>üöÄ Funcionalidades Implementadas</h3>
        <ul>
            <li>üåä Sistema nativo Leaflet com Canvas</li>
            <li>‚ö° Anima√ß√µes WebGL com deck.gl (fallback)</li>
            <li>üå™Ô∏è Part√≠culas de vento em tempo real</li>
            <li>üìç Marcadores animados SVG</li>
            <li>‚è∞ Timeline temporal interativa</li>
            <li>üé® Integra√ß√£o com API Windy.com</li>
            <li>‚ú® Anima√ß√µes Lottie personalizadas</li>
            <li>üé¨ Transi√ß√µes suaves com GSAP</li>
            <li>üí´ Efeitos de ondula√ß√£o</li>
            <li>üìä Monitoramento de performance</li>
        </ul>
    </div>

    <!-- Painel de Estat√≠sticas -->
    <div class="stats-panel">
        <h4>üìä Estat√≠sticas de Performance</h4>
        <div class="stat-item">
            <span>FPS:</span>
            <span id="fpsCounter">--</span>
        </div>
        <div class="stat-item">
            <span>Part√≠culas Ativas:</span>
            <span id="particleCount">--</span>
        </div>
        <div class="stat-item">
            <span>Anima√ß√µes Ativas:</span>
            <span id="animationCount">--</span>
        </div>
        <div class="stat-item">
            <span>Cache Hits:</span>
            <span id="cacheHits">--</span>
        </div>
    </div>

    <!-- Anima√ß√µes Flutuantes -->
    <div class="floating-animations">
        <div class="animation-item" onclick="triggerRandomAnimation()" title="Anima√ß√£o Aleat√≥ria">
            üé≤
        </div>
        <div class="animation-item" onclick="toggleWindAnimation()" title="Toggle Vento">
            üí®
        </div>
        <div class="animation-item" onclick="toggleWaveAnimation()" title="Toggle Ondas">
            üåä
        </div>
        <div class="animation-item" onclick="resetView()" title="Reset Visualiza√ß√£o">
            üîÑ
        </div>
    </div>

    <!-- Scripts -->
    <!-- Leaflet -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Deck.gl -->
    <script src="https://unpkg.com/deck.gl@8.9.35/dist.min.js"></script>
    
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
    
    <!-- Lottie -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    
    <!-- Sistemas BGAPP -->
    <script src="assets/js/leaflet-native-animations.js?v=2025-01-09-23-25"></script>
    <script src="assets/js/advanced-animation-system.js?v=2025-01-09-23-16"></script>
    <script src="assets/js/windy-api-integration.js?v=2025-01-09-23-15"></script>
    <script src="assets/js/lottie-animations.js?v=2025-01-09-23-15"></script>
    <script src="assets/js/gsap-transitions.js?v=2025-01-09-23-15"></script>
    
    <!-- Sistema de Anima√ß√£o de Vento Existente -->
    <script src="assets/js/wind-performance-config.js"></script>
    <script src="assets/js/wind-animation-core.js"></script>
    <script src="assets/js/wind-integration.js"></script>

    <script>
        // Vari√°veis globais
        let map;
        let advancedAnimationSystem;
        let leafletNativeAnimations;
        let leafletTimeAnimation;
        let windyClient;
        let lottieManager;
        let transitionManager;
        let performanceMonitor;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', async function() {
            console.log("üöÄ BGAPP Advanced Animations Demo - Iniciando...");
            
            try {
                // Mostrar loading
                showLoading(true);
                
                // Inicializar mapa
                await initializeMap();
                
                // Inicializar sistemas de anima√ß√£o
                await initializeAnimationSystems();
                
                // Setup de eventos
                setupEventListeners();
                
                // Inicializar monitor de performance
                initializePerformanceMonitor();
                
                // Esconder loading
                showLoading(false);
                
                // Mostrar notifica√ß√£o de sucesso
                setTimeout(() => {
                    if (transitionManager) {
                        transitionManager.showNotification(
                            "Sistema de anima√ß√µes carregado com sucesso!", 
                            'success'
                        );
                    }
                }, 1000);
                
                console.log("‚úÖ BGAPP Advanced Animations Demo - Inicializa√ß√£o completa");
                
            } catch (error) {
                console.error("‚ùå Erro na inicializa√ß√£o:", error);
                showLoading(false);
                
                if (transitionManager) {
                    transitionManager.showNotification(
                        "Erro ao carregar sistema de anima√ß√µes", 
                        'error'
                    );
                }
            }
        });

        // Inicializar mapa
        async function initializeMap() {
            map = L.map('map').setView([-8.8368, 13.2343], 8); // Luanda, Angola
            
            // Tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            console.log("üó∫Ô∏è Mapa inicializado");
        }

        // Inicializar sistemas de anima√ß√£o
        async function initializeAnimationSystems() {
            // Sistema nativo Leaflet
            leafletNativeAnimations = new BGAPPLeafletNativeAnimations(map, {
                particleCount: 2000,
                animationSpeed: 1.0,
                colorScheme: 'ocean',
                preferCanvas: true
            });
            
            // Sistema de anima√ß√£o temporal
            leafletTimeAnimation = new BGAPPLeafletTimeAnimation(map, {
                playbackSpeed: 500
            });
            
            // Sistema avan√ßado de anima√ß√£o (fallback)
            advancedAnimationSystem = new BGAPPAdvancedAnimationSystem(map, {
                particleCount: 5000,
                animationSpeed: 1.0,
                colorScheme: 'ocean'
            });
            
            await advancedAnimationSystem.initialize();
            
            // Cliente Windy API
            windyClient = new BGAPPWindyAPIClient({
                apiKey: 'demo-key',
                cacheTimeout: 300000
            });
            
            // Gerenciador Lottie
            lottieManager = new BGAPPLottieManager({
                preloadAnimations: true,
                quality: 'high'
            });
            
            // Gerenciador de transi√ß√µes GSAP
            transitionManager = new BGAPPTransitionManager({
                duration: 1,
                ease: "power2.out",
                debug: false
            });
            
            console.log("üé¨ Sistemas de anima√ß√£o inicializados");
        }

        // Setup de event listeners
        function setupEventListeners() {
            // Eventos do mapa
            map.on('zoomend', updateStats);
            map.on('moveend', updateStats);
            
            // Eventos de teclado
            document.addEventListener('keydown', handleKeyboard);
            
            console.log("üëÇ Event listeners configurados");
        }

        // Inicializar monitor de performance
        function initializePerformanceMonitor() {
            performanceMonitor = {
                fps: 0,
                frameCount: 0,
                lastTime: performance.now(),
                
                update: function() {
                    this.frameCount++;
                    const currentTime = performance.now();
                    
                    if (currentTime - this.lastTime >= 1000) {
                        this.fps = Math.round(this.frameCount * 1000 / (currentTime - this.lastTime));
                        this.frameCount = 0;
                        this.lastTime = currentTime;
                        
                        updateStats();
                    }
                    
                    requestAnimationFrame(() => this.update());
                }
            };
            
            performanceMonitor.update();
            console.log("üìä Monitor de performance inicializado");
        }

        // Atualizar estat√≠sticas
        function updateStats() {
            if (performanceMonitor) {
                document.getElementById('fpsCounter').textContent = performanceMonitor.fps;
            }
            
            if (advancedAnimationSystem) {
                document.getElementById('particleCount').textContent = 
                    advancedAnimationSystem.options.particleCount.toLocaleString();
            }
            
            if (transitionManager) {
                const stats = transitionManager.getStats();
                document.getElementById('animationCount').textContent = stats.activeAnimations;
            }
            
            if (windyClient) {
                const cacheStats = windyClient.getCacheStats();
                document.getElementById('cacheHits').textContent = cacheStats.size;
            }
        }

        // Controles de anima√ß√£o
        async function startLeafletNativeAnimations() {
            if (leafletNativeAnimations) {
                showLoading(true, "Iniciando anima√ß√µes nativas do Leaflet...");
                
                try {
                    // Obter dados de vento atuais
                    const bounds = map.getBounds();
                    const windData = await windyClient.getWindData({
                        north: bounds.getNorth(),
                        south: bounds.getSouth(),
                        east: bounds.getEast(),
                        west: bounds.getWest()
                    });
                    
                    const success = await leafletNativeAnimations.start(windData);
                    
                    if (success && transitionManager) {
                        transitionManager.showNotification("Anima√ß√µes nativas Leaflet iniciadas!", 'success');
                        
                        // Mostrar estat√≠sticas
                        const stats = leafletNativeAnimations.getStats();
                        console.log("Estat√≠sticas das anima√ß√µes nativas:", stats);
                    }
                } catch (error) {
                    console.error("Erro ao iniciar anima√ß√µes nativas:", error);
                    if (transitionManager) {
                        transitionManager.showNotification("Erro ao iniciar anima√ß√µes nativas", 'error');
                    }
                } finally {
                    showLoading(false);
                }
            }
        }

        async function startAdvancedAnimations() {
            if (advancedAnimationSystem) {
                const success = await advancedAnimationSystem.start();
                if (success && transitionManager) {
                    transitionManager.showNotification("Anima√ß√µes avan√ßadas iniciadas", 'success');
                }
            }
        }

        function pauseAllAnimations() {
            if (leafletNativeAnimations && leafletNativeAnimations.isActive) {
                leafletNativeAnimations.stop();
                console.log("Anima√ß√µes nativas Leaflet pausadas");
            }
            if (leafletTimeAnimation && leafletTimeAnimation.isPlaying) {
                leafletTimeAnimation.pause();
            }
            if (advancedAnimationSystem && advancedAnimationSystem.isActive) {
                advancedAnimationSystem.pause();
            }
            if (transitionManager) {
                transitionManager.pauseAll();
            }
            if (lottieManager) {
                lottieManager.pauseAll();
            }
        }

        function stopAllAnimations() {
            if (leafletNativeAnimations) {
                leafletNativeAnimations.stop();
            }
            if (leafletTimeAnimation) {
                leafletTimeAnimation.pause();
            }
            if (advancedAnimationSystem) {
                advancedAnimationSystem.stop();
            }
            if (transitionManager) {
                transitionManager.killAll();
            }
            if (lottieManager) {
                lottieManager.removeAll();
            }
            
            if (transitionManager) {
                transitionManager.showNotification("Todas as anima√ß√µes paradas", 'info');
            }
        }

        // Carregar dados meteorol√≥gicos
        async function loadWindyData() {
            showLoading(true, "Carregando dados de vento...");
            
            try {
                const bounds = map.getBounds();
                const data = await windyClient.getWindData({
                    north: bounds.getNorth(),
                    south: bounds.getSouth(),
                    east: bounds.getEast(),
                    west: bounds.getWest()
                });
                
                console.log("Dados de vento carregados:", data);
                
                if (transitionManager) {
                    transitionManager.showNotification("Dados de vento carregados", 'success');
                }
                
            } catch (error) {
                console.error("Erro ao carregar dados de vento:", error);
                if (transitionManager) {
                    transitionManager.showNotification("Erro ao carregar dados de vento", 'error');
                }
            } finally {
                showLoading(false);
            }
        }

        async function loadWaveData() {
            showLoading(true, "Carregando dados de ondas...");
            
            try {
                const bounds = map.getBounds();
                const data = await windyClient.getWaveData({
                    north: bounds.getNorth(),
                    south: bounds.getSouth(),
                    east: bounds.getEast(),
                    west: bounds.getWest()
                });
                
                console.log("Dados de ondas carregados:", data);
                
                if (transitionManager) {
                    transitionManager.showNotification("Dados de ondas carregados", 'success');
                }
                
            } catch (error) {
                console.error("Erro ao carregar dados de ondas:", error);
            } finally {
                showLoading(false);
            }
        }

        async function loadCurrentsData() {
            showLoading(true, "Carregando dados de correntes...");
            
            try {
                const bounds = map.getBounds();
                const data = await windyClient.getCurrentsData({
                    north: bounds.getNorth(),
                    south: bounds.getSouth(),
                    east: bounds.getEast(),
                    west: bounds.getWest()
                });
                
                console.log("Dados de correntes carregados:", data);
                
                if (transitionManager) {
                    transitionManager.showNotification("Dados de correntes carregados", 'success');
                }
                
            } catch (error) {
                console.error("Erro ao carregar dados de correntes:", error);
            } finally {
                showLoading(false);
            }
        }

        // Anima√ß√µes Lottie
        function showLoadingAnimation() {
            if (lottieManager) {
                lottieManager.createFloatingAnimation('loading', {
                    top: '100px',
                    right: '100px'
                }, {
                    autoRemove: true,
                    duration: 3000
                });
            }
        }

        function showSuccessAnimation() {
            if (lottieManager) {
                lottieManager.createFloatingAnimation('success', {
                    top: '150px',
                    right: '100px'
                }, {
                    autoRemove: true,
                    duration: 2000
                });
            }
        }

        function showWeatherAlert() {
            if (lottieManager) {
                lottieManager.createFloatingAnimation('alert', {
                    top: '200px',
                    right: '100px'
                }, {
                    loop: true
                });
            }
        }

        // Transi√ß√µes GSAP
        function animatePanel() {
            if (transitionManager) {
                const panel = document.querySelector('.control-panel');
                transitionManager.animate(panel, {
                    rotation: 360,
                    scale: 1.1,
                    duration: 1,
                    ease: "elastic.out(1, 0.3)",
                    onComplete: () => {
                        transitionManager.animate(panel, {
                            rotation: 0,
                            scale: 1,
                            duration: 0.5
                        });
                    }
                });
            }
        }

        function showNotification() {
            if (transitionManager) {
                const messages = [
                    "Sistema funcionando perfeitamente!",
                    "Dados atualizados com sucesso!",
                    "Performance otimizada!",
                    "Cache limpo automaticamente!"
                ];
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                transitionManager.showNotification(randomMessage, 'info');
            }
        }

        function animateCounters() {
            if (transitionManager) {
                // Animar contador de part√≠culas
                transitionManager.animateCounter('#particleCount', 
                    Math.floor(Math.random() * 10000), {
                    formatter: (value) => Math.round(value).toLocaleString()
                });
                
                // Animar contador de FPS
                transitionManager.animateCounter('#fpsCounter', 
                    Math.floor(Math.random() * 60), {
                    formatter: (value) => Math.round(value).toString()
                });
            }
        }

        // Controles de anima√ß√£o temporal
        function startTimeAnimation() {
            if (leafletTimeAnimation) {
                leafletTimeAnimation.play();
                if (transitionManager) {
                    transitionManager.showNotification("Timeline temporal iniciada", 'success');
                }
            }
        }

        function pauseTimeAnimation() {
            if (leafletTimeAnimation) {
                leafletTimeAnimation.pause();
                if (transitionManager) {
                    transitionManager.showNotification("Timeline temporal pausada", 'info');
                }
            }
        }

        function showRippleEffect() {
            if (map) {
                const center = map.getCenter();
                BGAPPLeafletAnimationUtils.createRippleEffect(map, center, {
                    maxRadius: 100,
                    duration: 3000,
                    color: '#4fc3f7',
                    onComplete: () => {
                        console.log("Efeito ondula√ß√£o completado");
                    }
                });
                
                if (transitionManager) {
                    transitionManager.showNotification("Efeito ondula√ß√£o criado!", 'success');
                }
            }
        }

        // Configura√ß√µes
        function updateAnimationSpeed(value) {
            document.getElementById('speedValue').textContent = `${value}x`;
            
            if (advancedAnimationSystem) {
                advancedAnimationSystem.options.animationSpeed = parseFloat(value);
            }
            
            if (lottieManager) {
                lottieManager.getActiveAnimations().forEach(info => {
                    lottieManager.setAnimationSpeed(info.id, parseFloat(value));
                });
            }
        }

        function updateParticleDensity(value) {
            document.getElementById('densityValue').textContent = value;
            
            if (advancedAnimationSystem) {
                advancedAnimationSystem.options.particleCount = parseInt(value);
            }
        }

        // Controles flutuantes
        function triggerRandomAnimation() {
            const animations = [
                showLoadingAnimation,
                showSuccessAnimation,
                animatePanel,
                showNotification
            ];
            
            const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
            randomAnimation();
        }

        function toggleWindAnimation() {
            if (advancedAnimationSystem) {
                if (advancedAnimationSystem.isActive) {
                    advancedAnimationSystem.pause();
                } else {
                    advancedAnimationSystem.start();
                }
            }
        }

        function toggleWaveAnimation() {
            // Implementar toggle de anima√ß√£o de ondas
            console.log("Toggle wave animation");
        }

        function resetView() {
            if (map) {
                map.setView([-8.8368, 13.2343], 8);
                
                if (transitionManager) {
                    transitionManager.showNotification("Visualiza√ß√£o resetada", 'info');
                }
            }
        }

        // Controles de teclado
        function handleKeyboard(event) {
            switch(event.key) {
                case ' ':
                    event.preventDefault();
                    if (advancedAnimationSystem && advancedAnimationSystem.isActive) {
                        advancedAnimationSystem.pause();
                    } else {
                        startAdvancedAnimations();
                    }
                    break;
                case 'r':
                case 'R':
                    resetView();
                    break;
                case 'n':
                case 'N':
                    showNotification();
                    break;
            }
        }

        // Utilit√°rios
        function showLoading(show, text = "Carregando...") {
            const overlay = document.getElementById('loadingOverlay');
            const textElement = overlay.querySelector('.loading-text');
            
            if (show) {
                textElement.textContent = text;
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }

        // Atualizar estat√≠sticas periodicamente
        setInterval(updateStats, 2000);
    </script>
</body>
</html>
